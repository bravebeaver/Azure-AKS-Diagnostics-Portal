<div class="category-container">
  <h2>AKS Periscope</h2>
  <p class="category-description">
    AKS Periscope allows AKS customers to collect and export the logs into an Azure Blob storage account
    to help analyze and identify potential problems or easily share the information to support to help 
    with the troubleshooting process. 
    <a target="_blank" rel="noopener" href="https://github.com/Azure/aks-periscope">Learn more</a>
  </p>

  <div *ngIf="status < toolStatus.Loaded">
    <i class="fa fa-circle-o-notch fa-spin spin-icon" aria-hidden="true"></i>
    Loading...
  </div>

  <div *ngIf="status >= toolStatus.Loaded" style="margin-top: 40px;">
    <collapsible-list-fabric [title]="'Configure'">
      <!--TODO list existing periscope runs -->
      <div header class="container">
        <div header class="summaryText">
          {{ periscopeRunningStatus }}
        </div>
      </div>
      <!--configure periscope run-->
      <collapsible-list-item body>
        <div class="container">
          <div>
            <div class="row mt-4">
              <div class="row">
                <div class="col-md-3 field-label"> Diagnotisc RunId <span class="required">*</span>
                  <fab-tooltip-host content="The identifier for a particular 'run' of Periscope. This will become the topmost container within the container name"
                    [directionalHint]="directionalHint" [tooltipOptions]="toolTipOptionsValue">
                    <img src="assets/img/info.svg" title="info" />
                  </fab-tooltip-host>
                </div>
                <div class="col-md-2">
                  <input type="text" aria-required="false" id="diagnosticRunId" placeholder="e.g. 2023-12-12T15-20-20Z" [(ngModel)]="diagnosticRunId">
                </div>  
              </div>
              <div class="col-md-3 field-label"> Storage account <span class="required">*</span>
                <fab-tooltip-host
                  content="The selected storage account will store the logs captured via AKS periscope. You can choose to use a storage account resource you own, 
                  or an account with a shared access signature token"
                  [directionalHint]="directionalHint" [tooltipOptions]="toolTipOptionsValue">
                  <img src="assets/img/info.svg" title="storage-account"/>
                </fab-tooltip-host>
              </div>
              <div class="col-md-2">
                <span> {{ storageAccountName }} </span>
                <div class="mt-1 mb-4" (click)="toggleStorageAccountPanel()" (keyup.enter)="toggleStorageAccountPanel()">
                  <a tabindex="0" role="button" name="Change storage account" aria-label="Change storage account">
                    {{ storageAccountName != null && storageAccountName.length > 0  ? 'Change' : 'Select' }}</a>
                </div>
              </div>
            </div>
          </div>

          <div class="row" *ngIf="error || errorMessage ||validationError">
            <div class="col-md-6 error-details">
              <i class="fa health-icon fa-times-circle unhealthy-icon-color" aria-hidden="true"></i>
              <span *ngIf="errorMessage">{{ errorMessage}}</span> &nbsp;<span *ngIf="error">{{ error}}</span>
              <span *ngIf="validationError">{{ validationError}}</span>
            </div>
          </div>

          <div class="mt-3 ml-3">
            <fab-primary-button [contentStyle]="'margin-right:10px;float:left'" [disabled]="validConfiguration" (onClick)="startPeriscope()">
              Run AKS periscope
            </fab-primary-button>
          </div>
        </div>
      </collapsible-list-item>
    </collapsible-list-fabric>
  </div>
</div>