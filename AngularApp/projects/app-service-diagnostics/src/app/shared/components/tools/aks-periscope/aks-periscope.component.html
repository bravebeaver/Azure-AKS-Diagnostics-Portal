<div class="category-container">
  <h2>AKS Periscope</h2>
  <p class="category-description">
    AKS Periscope allows AKS customers to collect and export the logs into an Azure Blob storage account
    to help analyze and identify potential problems or easily share the information to support to help 
    with the troubleshooting process. 
    <a target="_blank" rel="noopener" href="https://github.com/Azure/aks-periscope">Learn more</a>
  </p>

  <h3>What you should know before using runCommand </h3>
  <ul>
      <li>The runCommand is only available for AKS clusters with Azure AD enabled.
        <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/aks/command-invoke">Learn more</a>
      </li>
      <li> The periscope logs are stored in Azure Storage, please choose an account you are an owner of, or a Shared Access Service token can be used.</li>
  </ul>

  <div *ngIf="status < toolStatus.Loaded">
    <i class="fa fa-circle-o-notch fa-spin spin-icon" aria-hidden="true"></i>
    Loading...
  </div>

  <div style="margin-top: 40px;">
    <collapsible-list-fabric [title]="'Configure'">

      <!--configure periscope run-->
      <collapsible-list-item body>
        <div class="container">
          <div>
            <div class="row mt-4">
              <div class="row">
                <div class="col-md-3 field-label"> Diagnotisc RunId <span class="required">*</span>
                  <fab-tooltip-host content="The identifier for a particular 'run' of Periscope. This will become the topmost container within the container name"
                    [directionalHint]="directionalHint" [tooltipOptions]="toolTipOptionsValue">
                    <img src="assets/img/info.svg" title="info" />
                  </fab-tooltip-host>
                </div>
                <div class="col-md-2">
                  <input type="text" aria-required="false" id="diagnosticRunId" placeholder="e.g. 2023-12-12T15-20-20Z" [(ngModel)]="diagnosticRunId">
                </div>  
              </div>
              <div class="col-md-3 field-label"> Storage account <span class="required">*</span>
                <fab-tooltip-host
                  content="The selected storage account will store the logs captured via AKS periscope. You can choose to use a storage account resource you own, 
                  or an account with a shared access signature token"
                  [directionalHint]="directionalHint" [tooltipOptions]="toolTipOptionsValue">
                  <img src="assets/img/info.svg" title="storage-account"/>
                </fab-tooltip-host>
              </div>
              <div class="col-md-2">
                <span> {{ storageAccountName }} </span>
                <div class="mt-1 mb-4" (click)="toggleStorageAccountPanel()" (keyup.enter)="toggleStorageAccountPanel()">
                  <a tabindex="0" role="button" name="Change storage account" aria-label="Change storage account">
                    {{ storageAccountName != null && storageAccountName.length > 0  ? 'Change' : 'Select' }}</a>
                </div>
              </div>
            </div>
          </div>

          <div class="row" *ngIf="error || errorMessage ||validationError">
            <div class="col-md-6 error-details">
              <i class="fa health-icon fa-times-circle unhealthy-icon-color" aria-hidden="true"></i>
              <span *ngIf="errorMessage">{{ errorMessage}}</span> &nbsp;<span *ngIf="error">{{ error}}</span>
              <span *ngIf="validationError">{{ validationError}}</span>
            </div>
          </div>

          <div class="mt-3 ml-3">
            <fab-primary-button [contentStyle]="'margin-right:10px;float:left'" [disabled]="validConfiguration" (onClick)="startPeriscope()">
              Run AKS periscope
            </fab-primary-button>
          </div>
                <!--TODO list existing periscope runs -->
        </div>
        <div header class="container">
          <div header class="summaryText">
            <ul>
              <li *ngFor="let statusUpdate of diagnosticToolRunningStatus">{{ statusUpdate }}</li>
            </ul>
          </div>
        </div>
      </collapsible-list-item>
    </collapsible-list-fabric>
  </div>
</div>